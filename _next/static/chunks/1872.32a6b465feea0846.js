(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1872],{20218:()=>{},29696:()=>{},40820:()=>{},51872:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>N});var l=n(72548),s=n(6152),i=n(40759);let r={pan:"pan",selection:"selection",rectangle:"rectangle",line:"line",pencil:"pencil",text:"text"};var o=n(24262),a=n(97079),c=n(94793),d=n(38369),u=n(97151);function x(){let[e,t]=(0,s.useState)(!1);return(0,l.jsxs)("div",{children:[(0,l.jsx)("button",{className:"infoButton","aria-label":"Open information dialog",onClick:()=>t(!0),children:(0,l.jsx)(o.MGr,{})}),(0,l.jsxs)(a.A,{onClose:()=>t(!1),"aria-labelledby":"customized-dialog-title",open:e,PaperProps:{style:{borderRadius:"10px"}},children:[(0,l.jsx)(c.A,{sx:{m:0,p:2},id:"customized-dialog-title",className:"DialogTitle",children:"How to Use NinjaSketch"}),(0,l.jsx)(d.A,{"aria-label":"close",onClick:()=>t(!1),sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},className:"IconButton",children:(0,l.jsx)(u.A,{className:"CloseIcon"})}),(0,l.jsxs)("div",{className:"infoContent",children:[(0,l.jsx)("p",{children:"Welcome to NinjaSketch! Get started with these simple steps:"}),(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Choose a Tool:"})," Select from pencil, line, rectangle, or text tools to start drawing."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Draw & Move:"})," Click and drag on the canvas to draw. Select an element and drag to move."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Edit Text:"})," Select the text tool and click on the canvas to start typing."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Zoom:"})," Use Ctrl + Scroll to zoom in and out of the canvas."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Pan:"})," Hold Space and drag to move around the canvas, or hold the middle mouse button."]})]}),(0,l.jsx)("p",{children:"Keyboard Shortcuts:"}),(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Undo:"})," Ctrl + Z"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Redo:"})," Ctrl + Y or Ctrl + Shift + Z"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Zoom In:"})," Ctrl + Plus"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Zoom Out:"})," Ctrl + Minus"]})]}),(0,l.jsx)("p",{children:"Enjoy creating your masterpiece!"})]})]})]})}n(29696);var h=n(31326),p=n(48524),f=n(21724);function g(e){let{tool:t,setTool:n}=e;return(0,l.jsx)("div",{className:"actionBar",children:Object.values(r).map((e,s)=>(0,l.jsxs)("div",{className:"inputWrapper ".concat(t===e?"selected":""),onClick:()=>n(e),children:[(0,l.jsx)("input",{type:"radio",id:e,checked:t===e,onChange:()=>n(e),readOnly:!0}),(0,l.jsx)("label",{htmlFor:e,children:e}),"pan"===e&&(0,l.jsx)(f.uMF,{}),"selection"===e&&(0,l.jsx)(p._cq,{}),"rectangle"===e&&(0,l.jsx)(p.TG1,{}),"line"===e&&(0,l.jsx)(p.QLg,{}),"pencil"===e&&(0,l.jsx)(h.H6t,{}),"text"===e&&(0,l.jsx)(f.e76,{}),(0,l.jsx)("span",{children:s+1})]},e))})}n(40820);var y=n(97748);n(51747),n(20218);var m=n(83254),j=n(11336);function w(e){let{undo:t,redo:n,onZoom:s,scale:i,setScale:r}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"controlPanel",children:[(0,l.jsxs)("div",{className:"zoomPanel",children:[(0,l.jsx)(y.Ay,{content:"Zoom Out",children:(0,l.jsx)("button",{onClick:()=>s(-.1),"aria-label":"Zoom Out",children:(0,l.jsx)(m.uPM,{})})}),(0,l.jsx)(y.Ay,{content:"Set scale to 100%",children:(0,l.jsx)("button",{onClick:()=>r(1),"aria-label":"Set scale to 100%",children:new Intl.NumberFormat("en-GB",{style:"percent"}).format(i)})}),(0,l.jsx)(y.Ay,{content:"Zoom In",children:(0,l.jsx)("button",{onClick:()=>s(.1),"aria-label":"Zoom In",children:(0,l.jsx)(m.enO,{})})})]}),(0,l.jsxs)("div",{className:"editPanel",children:[(0,l.jsx)(y.Ay,{content:"Undo last action",children:(0,l.jsx)("button",{onClick:t,"aria-label":"Undo last action",children:(0,l.jsx)(j.cyc,{})})}),(0,l.jsx)(y.Ay,{content:"Redo last action",children:(0,l.jsx)("button",{onClick:n,"aria-label":"Redo last action",children:(0,l.jsx)(j.r4$,{})})})]})]})," ",(0,l.jsxs)("a",{className:"link",href:"https://github.com/mirayatech",target:"_blank",children:[(0,l.jsx)(p.BR8,{}),"Created by Miraya"]})]})}var v=n(6109);let b=(e,t,n,l,s,o)=>{let a=i.A.generator();switch(o){case r.line:case r.rectangle:{let i=o===r.line?a.line(t,n,l,s):a.rectangle(t,n,l-t,s-n,{roughness:0,fill:"red"});return{id:e,x1:t,y1:n,x2:l,y2:s,type:o,roughElement:i}}case r.pencil:return{id:e,x1:0,y1:0,x2:0,y2:0,type:o,points:[{x:t,y:n}],roughElement:null};case r.text:return{id:e,type:o,x1:t,y1:n,x2:l,y2:s,text:""};default:throw Error("Type not recognised: ".concat(o))}},k=(e,t,n,l,s)=>5>Math.abs(e-n)&&5>Math.abs(t-l)?s:null,E=(e,t,n)=>n.map(n=>({...n,position:S(e,t,n)})).find(e=>null!==e.position),S=(e,t,n)=>{let{type:l,x1:s,x2:i,y1:o,y2:a}=n;switch(l){case r.line:{let n=C(s,o,i,a,e,t),l=k(e,t,s,o,"start"),r=k(e,t,i,a,"end");return l||r||n}case r.rectangle:{let n=k(e,t,s,o,"topLeft"),l=k(e,t,i,o,"topRight"),r=k(e,t,s,a,"bottomLeft"),c=k(e,t,i,a,"bottomRight"),d=e>=s&&e<=i&&t>=o&&t<=a?"inside":null;return n||l||r||c||d}case r.pencil:return n.points.some((l,s)=>{let i=n.points[s+1];return!!i&&null!=C(l.x,l.y,i.x,i.y,e,t,5)})?"inside":null;case r.text:return e>=s&&e<=i&&t>=o&&t<=a?"inside":null;default:throw Error("Type not recognised: ".concat(l))}},C=function(e,t,n,l,s,i){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o={x:e,y:t},a={x:n,y:l},c={x:s,y:i};return Math.abs(M(o,a)-(M(o,c)+M(a,c)))<r?"inside":null},M=(e,t)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function N(){let e=r.selection,{elements:t,setElements:n,undo:o,redo:a}=(e=>{let[t,n]=(0,s.useState)(0),[l,i]=(0,s.useState)([e]);return{elements:l[t],setElements:function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="function"==typeof e?e(l[t]):e;if(s){let e=[...l];e[t]=r,i(e)}else i([...[...l].slice(0,t+1),r]),n(e=>e+1)},undo:()=>t>0&&n(e=>e-1),redo:()=>t<l.length-1&&n(e=>e+1)}})([]),[c,d]=(0,s.useState)({x:0,y:0}),[u,h]=(0,s.useState)({x:0,y:0}),[p,f]=(0,s.useState)("none"),[y,m]=(0,s.useState)(e),[j,k]=(0,s.useState)(),[S,C]=(0,s.useState)(1),[M,N]=(0,s.useState)({x:0,y:0}),L=(0,s.useRef)(null),A=(()=>{let[e,t]=(0,s.useState)(new Set);return(0,s.useEffect)(()=>{let e=e=>{t(t=>new Set(t).add(e.key))},n=e=>{t(t=>{let n=new Set(t);return n.delete(e.key),n})};return window.addEventListener("keydown",e),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n)}},[]),e})();(0,s.useLayoutEffect)(()=>{let e=document.getElementById("canvas"),n=e.getContext("2d"),l=i.A.canvas(e);n.clearRect(0,0,e.width,e.height);let s=e.width*S,r=e.height*S,o=(s-e.width)/2,a=(r-e.height)/2;N({x:o,y:a}),n.save(),n.translate(c.x*S-o,c.y*S-a),n.scale(S,S),t.forEach(e=>{if("writing"!==p||!j||j.id!==e.id)switch(e.type){case"line":case"rectangle":l.draw(e.roughElement);break;case"pencil":{if(!e.points)throw Error("Pencil element points are undefined");let t=(e=>{if(!e.length)return"";let t=e.reduce((e,t,n,l)=>{let[s,i]=t,[r,o]=l[(n+1)%l.length];return e.push(s.toString(),i.toString(),((s+r)/2).toString(),((i+o)/2).toString()),e},["M",...e[0].map(e=>e.toString()),"Q"]);return t.push("Z"),t.join(" ")})((0,v.Ay)(e.points).map(e=>{if(2!==e.length)throw Error("Expected point to have exactly 2 elements, got ".concat(e.length));return[e[0],e[1]]}));n.fill(new Path2D(t));break}case"text":{n.textBaseline="top",n.font="24px sans-serif";let t=e.text||"";n.fillText(t,e.x1,e.y1);break}default:throw Error("Type not recognised: ".concat(e.type))}}),n.restore()},[t,p,j,c,S]),(0,s.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&("z"===e.key?e.shiftKey?a():o():"y"===e.key&&a())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[o,a]),(0,s.useEffect)(()=>{let e=e=>{A.has("Meta")||A.has("Control")?z(-.01*e.deltaY):d(t=>({x:t.x-e.deltaX,y:t.y-e.deltaY}))};return document.addEventListener("wheel",e),()=>{document.removeEventListener("wheel",e)}},[A]),(0,s.useEffect)(()=>{let e=L.current;"writing"===p&&e&&j&&setTimeout(()=>{e.focus(),e.value=j.text||""},0)},[p,j]);let R=(e,l,s,i,o,a,c)=>{let d=[...t];switch(a){case r.line:case r.rectangle:d[e]=b(e,l,s,i,o,a);break;case r.pencil:{let t=d[e].points||[];d[e].points=[...t,{x:i,y:o}];break}case r.text:{let t=document.getElementById("canvas");if(!(t instanceof HTMLCanvasElement))throw Error("Canvas element not found");let n=t.getContext("2d");if(!n)throw Error("Could not get 2D context from canvas");if(!c)throw Error("No text options provided for text tool");let i=n.measureText(c.text).width;d[e]={...b(e,l,s,l+i,s+24,a),text:c.text};break}default:throw Error("Type not recognised: ".concat(a))}n(d,!0)},T=e=>({clientX:(e.clientX-c.x*S+M.x)/S,clientY:(e.clientY-c.y*S+M.y)/S}),z=e=>{C(t=>Math.min(Math.max(t+e,.1),20))};return(0,l.jsxs)("div",{children:[(0,l.jsx)(x,{}),(0,l.jsx)(g,{tool:y,setTool:m}),(0,l.jsx)(w,{undo:o,redo:a,onZoom:z,scale:S,setScale:C}),"writing"===p?(0,l.jsx)("textarea",{ref:L,onBlur:e=>{if(j){let{id:t,x1:n,y1:l,type:s}=j,i=j.x2||n,r=j.y2||l;f("none"),k(null),R(t,n,l,i,r,s,{text:e.target.value})}else console.error("No element selected when handleBlur was called")},className:"textArea",style:{top:j?(j.y1-2)*S+c.y*S-M.y:0,left:j?j.x1*S+c.x*S-M.x:0,font:"".concat(24*S,"px sans-serif")}}):null,(0,l.jsx)("canvas",{id:"canvas",width:window.innerWidth,height:window.innerHeight,onMouseDown:e=>{if("writing"===p)return;let{clientX:l,clientY:s}=T(e);if(y===r.pan||1===e.button||A.has(" ")||1===e.button||A.has(" ")){f("panning"),h({x:l,y:s}),document.body.style.cursor="grabbing";return}if(y===r.selection){let e=E(l,s,t);if(e){let t={...e};if("pencil"===e.type&&e.points){let n=e.points.map(e=>l-e.x),i=e.points.map(e=>s-e.y);t={...t,xOffsets:n,yOffsets:i}}else{let e=l-t.x1,n=s-t.y1;t={...t,offsetX:e,offsetY:n}}k(t),n(e=>e),"inside"===e.position?f("moving"):f("resizing")}}else{let e=b(t.length,l,s,l,s,y);n(t=>[...t,e]),k(e),f("text"===y?"writing":"drawing")}},onMouseMove:e=>{let{clientX:l,clientY:s}=T(e);if("panning"===p){let e=l-u.x,t=s-u.y;d({x:c.x+e,y:c.y+t});return}if(y===r.selection){let n=E(l,s,t);n&&n.position?e.target.style.cursor=(e=>{switch(e){case"topLeft":case"bottomRight":return"nwse-resize";case"topRight":case"bottomLeft":return"nesw-resize";case"start":case"end":case"inside":return"move";default:return"default"}})(n.position):e.target.style.cursor="default"}if("drawing"===p){let e=t.length-1,{x1:n,y1:i}=t[e];R(e,n,i,l,s,y)}else if("moving"===p&&j)if("pencil"===j.type&&"points"in j&&"xOffsets"in j&&"yOffsets"in j){let e=j.points.map((e,t)=>({x:l-j.xOffsets[t],y:s-j.yOffsets[t]})),i=[...t];i[j.id]={...i[j.id],points:e},n(i,!0)}else{let{id:e,x1:t,x2:n,y1:i,y2:r,type:o,offsetX:a,offsetY:c}=j,d=l-(null!=a?a:0),u=s-(null!=c?c:0),x="text"===o&&j.text?{text:j.text}:void 0;R(e,d,u,d+(n-t),u+(r-i),o,x)}else if("resizing"===p&&j&&j.position){let{id:e,type:t,position:n,...i}=j;if("string"==typeof n){let{x1:r,y1:o,x2:a,y2:c}=((e,t,n,l)=>{let{x1:s,y1:i,x2:r,y2:o}=l;switch(n){case"start":case"topLeft":return{x1:e,y1:t,x2:r,y2:o};case"topRight":return{x1:s,y1:t,x2:e,y2:o};case"bottomLeft":return{x1:e,y1:i,x2:r,y2:t};case"end":case"bottomRight":return{x1:s,y1:i,x2:e,y2:t};default:return l}})(l,s,n,i);R(e,r,o,a,c,t)}}},onMouseUp:e=>{let{clientX:n,clientY:l}=T(e);if(j){let e=j.id,{id:s,type:i}=t[e];if(("drawing"===p||"resizing"===p)&&["line","rectangle"].includes(i)){let{x1:n,y1:l,x2:o,y2:a}=(e=>{let{type:t,x1:n,y1:l,x2:s,y2:i}=e;return t===r.rectangle?{x1:Math.min(n,s),y1:Math.min(l,i),x2:Math.max(n,s),y2:Math.max(l,i)}:n<s||n===s&&l<i?{x1:n,y1:l,x2:s,y2:i}:{x1:s,y1:i,x2:n,y2:l}})(t[e]);R(s,n,l,o,a,i)}let o=j.offsetX||0,a=j.offsetY||0;if("text"===j.type&&n-o===j.x1&&l-a===j.y1)return void f("writing")}"writing"!==p&&("panning"===p&&(document.body.style.cursor="default"),f("none"),k(null))},style:{position:"absolute",zIndex:1}})]})}}}]);