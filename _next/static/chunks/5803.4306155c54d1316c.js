(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5803],{32411:()=>{},35803:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>N});var s=n(45182),l=n(39950),r=n(40759);let i={pan:"pan",selection:"selection",rectangle:"rectangle",line:"line",pencil:"pencil",text:"text"};var o=n(25045),a=n(99010),c=n(26163),d=n(35395),u=n(83035);function x(){let[e,t]=(0,l.useState)(!1);return(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{className:"infoButton","aria-label":"Open information dialog",onClick:()=>t(!0),children:(0,s.jsx)(o.MGr,{})}),(0,s.jsxs)(a.A,{onClose:()=>t(!1),"aria-labelledby":"customized-dialog-title",open:e,PaperProps:{style:{borderRadius:"10px"}},children:[(0,s.jsx)(c.A,{sx:{m:0,p:2},id:"customized-dialog-title",className:"DialogTitle",children:"How to Use NinjaSketch"}),(0,s.jsx)(d.A,{"aria-label":"close",onClick:()=>t(!1),sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},className:"IconButton",children:(0,s.jsx)(u.A,{className:"CloseIcon"})}),(0,s.jsxs)("div",{className:"infoContent",children:[(0,s.jsx)("p",{children:"Welcome to NinjaSketch! Get started with these simple steps:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Choose a Tool:"})," Select from pencil, line, rectangle, or text tools to start drawing."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Draw & Move:"})," Click and drag on the canvas to draw. Select an element and drag to move."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Edit Text:"})," Select the text tool and click on the canvas to start typing."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Zoom:"})," Use Ctrl + Scroll to zoom in and out of the canvas."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Pan:"})," Hold Space and drag to move around the canvas, or hold the middle mouse button."]})]}),(0,s.jsx)("p",{children:"Keyboard Shortcuts:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Undo:"})," Ctrl + Z"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Redo:"})," Ctrl + Y or Ctrl + Shift + Z"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Zoom In:"})," Ctrl + Plus"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Zoom Out:"})," Ctrl + Minus"]})]}),(0,s.jsx)("p",{children:"Enjoy creating your masterpiece!"})]})]})]})}n(32411);var h=n(66697),p=n(41255),y=n(5153);function f({tool:e,setTool:t}){return(0,s.jsx)("div",{className:"actionBar",children:Object.values(i).map((n,l)=>(0,s.jsxs)("div",{className:`inputWrapper ${e===n?"selected":""}`,onClick:()=>t(n),children:[(0,s.jsx)("input",{type:"radio",id:n,checked:e===n,onChange:()=>t(n),readOnly:!0}),(0,s.jsx)("label",{htmlFor:n,children:n}),"pan"===n&&(0,s.jsx)(y.uMF,{}),"selection"===n&&(0,s.jsx)(p._cq,{}),"rectangle"===n&&(0,s.jsx)(p.TG1,{}),"line"===n&&(0,s.jsx)(p.QLg,{}),"pencil"===n&&(0,s.jsx)(h.H6t,{}),"text"===n&&(0,s.jsx)(y.e76,{}),(0,s.jsx)("span",{children:l+1})]},n))})}n(36823);var g=n(71974);n(84414),n(94529);var m=n(70953),j=n(62665);function w({undo:e,redo:t,onZoom:n,scale:l,setScale:r}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"controlPanel",children:[(0,s.jsxs)("div",{className:"zoomPanel",children:[(0,s.jsx)(g.Ay,{content:"Zoom Out",children:(0,s.jsx)("button",{onClick:()=>n(-.1),"aria-label":"Zoom Out",children:(0,s.jsx)(m.uPM,{})})}),(0,s.jsx)(g.Ay,{content:"Set scale to 100%",children:(0,s.jsx)("button",{onClick:()=>r(1),"aria-label":"Set scale to 100%",children:new Intl.NumberFormat("en-GB",{style:"percent"}).format(l)})}),(0,s.jsx)(g.Ay,{content:"Zoom In",children:(0,s.jsx)("button",{onClick:()=>n(.1),"aria-label":"Zoom In",children:(0,s.jsx)(m.enO,{})})})]}),(0,s.jsxs)("div",{className:"editPanel",children:[(0,s.jsx)(g.Ay,{content:"Undo last action",children:(0,s.jsx)("button",{onClick:e,"aria-label":"Undo last action",children:(0,s.jsx)(j.cyc,{})})}),(0,s.jsx)(g.Ay,{content:"Redo last action",children:(0,s.jsx)("button",{onClick:t,"aria-label":"Redo last action",children:(0,s.jsx)(j.r4$,{})})})]})]})," ",(0,s.jsxs)("a",{className:"link",href:"https://github.com/mirayatech",target:"_blank",children:[(0,s.jsx)(p.BR8,{}),"Created by Miraya"]})]})}var v=n(6109);let b=(e,t,n,s,l,o)=>{let a=r.A.generator();switch(o){case i.line:case i.rectangle:{let r=o===i.line?a.line(t,n,s,l):a.rectangle(t,n,s-t,l-n,{roughness:0,fill:"red"});return{id:e,x1:t,y1:n,x2:s,y2:l,type:o,roughElement:r}}case i.pencil:return{id:e,x1:0,y1:0,x2:0,y2:0,type:o,points:[{x:t,y:n}],roughElement:null};case i.text:return{id:e,type:o,x1:t,y1:n,x2:s,y2:l,text:""};default:throw Error(`Type not recognised: ${o}`)}},k=(e,t,n,s,l)=>5>Math.abs(e-n)&&5>Math.abs(t-s)?l:null,E=(e,t,n)=>n.map(n=>({...n,position:S(e,t,n)})).find(e=>null!==e.position),S=(e,t,n)=>{let{type:s,x1:l,x2:r,y1:o,y2:a}=n;switch(s){case i.line:{let n=C(l,o,r,a,e,t),s=k(e,t,l,o,"start"),i=k(e,t,r,a,"end");return s||i||n}case i.rectangle:{let n=k(e,t,l,o,"topLeft"),s=k(e,t,r,o,"topRight"),i=k(e,t,l,a,"bottomLeft"),c=k(e,t,r,a,"bottomRight"),d=e>=l&&e<=r&&t>=o&&t<=a?"inside":null;return n||s||i||c||d}case i.pencil:return n.points.some((s,l)=>{let r=n.points[l+1];return!!r&&null!=C(s.x,s.y,r.x,r.y,e,t,5)})?"inside":null;case i.text:return e>=l&&e<=r&&t>=o&&t<=a?"inside":null;default:throw Error(`Type not recognised: ${s}`)}},C=(e,t,n,s,l,r,i=1)=>{let o={x:e,y:t},a={x:n,y:s},c={x:l,y:r};return Math.abs(M(o,a)-(M(o,c)+M(a,c)))<i?"inside":null},M=(e,t)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function N(){let e=i.selection,{elements:t,setElements:n,undo:o,redo:a}=(e=>{let[t,n]=(0,l.useState)(0),[s,r]=(0,l.useState)([e]);return{elements:s[t],setElements:(e,l=!1)=>{let i="function"==typeof e?e(s[t]):e;if(l){let e=[...s];e[t]=i,r(e)}else r([...[...s].slice(0,t+1),i]),n(e=>e+1)},undo:()=>t>0&&n(e=>e-1),redo:()=>t<s.length-1&&n(e=>e+1)}})([]),[c,d]=(0,l.useState)({x:0,y:0}),[u,h]=(0,l.useState)({x:0,y:0}),[p,y]=(0,l.useState)("none"),[g,m]=(0,l.useState)(e),[j,k]=(0,l.useState)(),[S,C]=(0,l.useState)(1),[M,N]=(0,l.useState)({x:0,y:0}),L=(0,l.useRef)(null),A=(()=>{let[e,t]=(0,l.useState)(new Set);return(0,l.useEffect)(()=>{let e=e=>{t(t=>new Set(t).add(e.key))},n=e=>{t(t=>{let n=new Set(t);return n.delete(e.key),n})};return window.addEventListener("keydown",e),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n)}},[]),e})();(0,l.useLayoutEffect)(()=>{let e=document.getElementById("canvas"),n=e.getContext("2d"),s=r.A.canvas(e);n.clearRect(0,0,e.width,e.height);let l=e.width*S,i=e.height*S,o=(l-e.width)/2,a=(i-e.height)/2;N({x:o,y:a}),n.save(),n.translate(c.x*S-o,c.y*S-a),n.scale(S,S),t.forEach(e=>{if("writing"!==p||!j||j.id!==e.id)switch(e.type){case"line":case"rectangle":s.draw(e.roughElement);break;case"pencil":{if(!e.points)throw Error("Pencil element points are undefined");let t=(e=>{if(!e.length)return"";let t=e.reduce((e,[t,n],s,l)=>{let[r,i]=l[(s+1)%l.length];return e.push(t.toString(),n.toString(),((t+r)/2).toString(),((n+i)/2).toString()),e},["M",...e[0].map(e=>e.toString()),"Q"]);return t.push("Z"),t.join(" ")})((0,v.Ay)(e.points).map(e=>{if(2!==e.length)throw Error(`Expected point to have exactly 2 elements, got ${e.length}`);return[e[0],e[1]]}));n.fill(new Path2D(t));break}case"text":{n.textBaseline="top",n.font="24px sans-serif";let t=e.text||"";n.fillText(t,e.x1,e.y1);break}default:throw Error(`Type not recognised: ${e.type}`)}}),n.restore()},[t,p,j,c,S]),(0,l.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&("z"===e.key?e.shiftKey?a():o():"y"===e.key&&a())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[o,a]),(0,l.useEffect)(()=>{let e=e=>{A.has("Meta")||A.has("Control")?z(-.01*e.deltaY):d(t=>({x:t.x-e.deltaX,y:t.y-e.deltaY}))};return document.addEventListener("wheel",e),()=>{document.removeEventListener("wheel",e)}},[A]),(0,l.useEffect)(()=>{let e=L.current;"writing"===p&&e&&j&&setTimeout(()=>{e.focus(),e.value=j.text||""},0)},[p,j]);let R=(e,s,l,r,o,a,c)=>{let d=[...t];switch(a){case i.line:case i.rectangle:d[e]=b(e,s,l,r,o,a);break;case i.pencil:{let t=d[e].points||[];d[e].points=[...t,{x:r,y:o}];break}case i.text:{let t=document.getElementById("canvas");if(!(t instanceof HTMLCanvasElement))throw Error("Canvas element not found");let n=t.getContext("2d");if(!n)throw Error("Could not get 2D context from canvas");if(!c)throw Error("No text options provided for text tool");let r=n.measureText(c.text).width;d[e]={...b(e,s,l,s+r,l+24,a),text:c.text};break}default:throw Error(`Type not recognised: ${a}`)}n(d,!0)},T=e=>({clientX:(e.clientX-c.x*S+M.x)/S,clientY:(e.clientY-c.y*S+M.y)/S}),z=e=>{C(t=>Math.min(Math.max(t+e,.1),20))};return(0,s.jsxs)("div",{children:[(0,s.jsx)(x,{}),(0,s.jsx)(f,{tool:g,setTool:m}),(0,s.jsx)(w,{undo:o,redo:a,onZoom:z,scale:S,setScale:C}),"writing"===p?(0,s.jsx)("textarea",{ref:L,onBlur:e=>{if(j){let{id:t,x1:n,y1:s,type:l}=j,r=j.x2||n,i=j.y2||s;y("none"),k(null),R(t,n,s,r,i,l,{text:e.target.value})}else console.error("No element selected when handleBlur was called")},className:"textArea",style:{top:j?(j.y1-2)*S+c.y*S-M.y:0,left:j?j.x1*S+c.x*S-M.x:0,font:`${24*S}px sans-serif`}}):null,(0,s.jsx)("canvas",{id:"canvas",width:window.innerWidth,height:window.innerHeight,onMouseDown:e=>{if("writing"===p)return;let{clientX:s,clientY:l}=T(e);if(g===i.pan||1===e.button||A.has(" ")||1===e.button||A.has(" ")){y("panning"),h({x:s,y:l}),document.body.style.cursor="grabbing";return}if(g===i.selection){let e=E(s,l,t);if(e){let t={...e};if("pencil"===e.type&&e.points){let n=e.points.map(e=>s-e.x),r=e.points.map(e=>l-e.y);t={...t,xOffsets:n,yOffsets:r}}else{let e=s-t.x1,n=l-t.y1;t={...t,offsetX:e,offsetY:n}}k(t),n(e=>e),"inside"===e.position?y("moving"):y("resizing")}}else{let e=b(t.length,s,l,s,l,g);n(t=>[...t,e]),k(e),y("text"===g?"writing":"drawing")}},onMouseMove:e=>{let{clientX:s,clientY:l}=T(e);if("panning"===p){let e=s-u.x,t=l-u.y;d({x:c.x+e,y:c.y+t});return}if(g===i.selection){let n=E(s,l,t);n&&n.position?e.target.style.cursor=(e=>{switch(e){case"topLeft":case"bottomRight":return"nwse-resize";case"topRight":case"bottomLeft":return"nesw-resize";case"start":case"end":case"inside":return"move";default:return"default"}})(n.position):e.target.style.cursor="default"}if("drawing"===p){let e=t.length-1,{x1:n,y1:r}=t[e];R(e,n,r,s,l,g)}else if("moving"===p&&j)if("pencil"===j.type&&"points"in j&&"xOffsets"in j&&"yOffsets"in j){let e=j.points.map((e,t)=>({x:s-j.xOffsets[t],y:l-j.yOffsets[t]})),r=[...t];r[j.id]={...r[j.id],points:e},n(r,!0)}else{let{id:e,x1:t,x2:n,y1:r,y2:i,type:o,offsetX:a,offsetY:c}=j,d=s-(a??0),u=l-(c??0),x="text"===o&&j.text?{text:j.text}:void 0;R(e,d,u,d+(n-t),u+(i-r),o,x)}else if("resizing"===p&&j&&j.position){let{id:e,type:t,position:n,...r}=j;if("string"==typeof n){let{x1:i,y1:o,x2:a,y2:c}=((e,t,n,s)=>{let{x1:l,y1:r,x2:i,y2:o}=s;switch(n){case"start":case"topLeft":return{x1:e,y1:t,x2:i,y2:o};case"topRight":return{x1:l,y1:t,x2:e,y2:o};case"bottomLeft":return{x1:e,y1:r,x2:i,y2:t};case"end":case"bottomRight":return{x1:l,y1:r,x2:e,y2:t};default:return s}})(s,l,n,r);R(e,i,o,a,c,t)}}},onMouseUp:e=>{let{clientX:n,clientY:s}=T(e);if(j){let e=j.id,{id:l,type:r}=t[e];if(("drawing"===p||"resizing"===p)&&["line","rectangle"].includes(r)){let{x1:n,y1:s,x2:o,y2:a}=(e=>{let{type:t,x1:n,y1:s,x2:l,y2:r}=e;return t===i.rectangle?{x1:Math.min(n,l),y1:Math.min(s,r),x2:Math.max(n,l),y2:Math.max(s,r)}:n<l||n===l&&s<r?{x1:n,y1:s,x2:l,y2:r}:{x1:l,y1:r,x2:n,y2:s}})(t[e]);R(l,n,s,o,a,r)}let o=j.offsetX||0,a=j.offsetY||0;if("text"===j.type&&n-o===j.x1&&s-a===j.y1)return void y("writing")}"writing"!==p&&("panning"===p&&(document.body.style.cursor="default"),y("none"),k(null))},style:{position:"absolute",zIndex:1}})]})}},36823:()=>{},94529:()=>{}}]);