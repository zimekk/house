(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[641],{30461:()=>{},84641:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>B});var l=n(80263),s=n(53239),i=n(40759);let r=e=>{let[t,n]=(0,s.useState)(0),[l,i]=(0,s.useState)([e]);return{elements:l[t],setElements:function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="function"==typeof e?e(l[t]):e;if(s){let e=[...l];e[t]=r,i(e)}else i([...[...l].slice(0,t+1),r]),n(e=>e+1)},undo:()=>t>0&&n(e=>e-1),redo:()=>t<l.length-1&&n(e=>e+1)}},o=()=>{let[e,t]=(0,s.useState)(new Set);return(0,s.useEffect)(()=>{let e=e=>{t(t=>new Set(t).add(e.key))},n=e=>{t(t=>{let n=new Set(t);return n.delete(e.key),n})};return window.addEventListener("keydown",e),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n)}},[]),e},a={pan:"pan",selection:"selection",rectangle:"rectangle",line:"line",pencil:"pencil",text:"text"};var c=n(16058),d=n(43837),u=n(4710),x=n(14210),h=n(44655);function p(){let[e,t]=(0,s.useState)(!1);return(0,l.jsxs)("div",{children:[(0,l.jsx)("button",{className:"infoButton","aria-label":"Open information dialog",onClick:()=>t(!0),children:(0,l.jsx)(c.MGr,{})}),(0,l.jsxs)(d.A,{onClose:()=>t(!1),"aria-labelledby":"customized-dialog-title",open:e,PaperProps:{style:{borderRadius:"10px"}},children:[(0,l.jsx)(u.A,{sx:{m:0,p:2},id:"customized-dialog-title",className:"DialogTitle",children:"How to Use NinjaSketch"}),(0,l.jsx)(x.A,{"aria-label":"close",onClick:()=>t(!1),sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},className:"IconButton",children:(0,l.jsx)(h.A,{className:"CloseIcon"})}),(0,l.jsxs)("div",{className:"infoContent",children:[(0,l.jsx)("p",{children:"Welcome to NinjaSketch! Get started with these simple steps:"}),(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Choose a Tool:"})," Select from pencil, line, rectangle, or text tools to start drawing."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Draw & Move:"})," Click and drag on the canvas to draw. Select an element and drag to move."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Edit Text:"})," Select the text tool and click on the canvas to start typing."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Zoom:"})," Use Ctrl + Scroll to zoom in and out of the canvas."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Pan:"})," Hold Space and drag to move around the canvas, or hold the middle mouse button."]})]}),(0,l.jsx)("p",{children:"Keyboard Shortcuts:"}),(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Undo:"})," Ctrl + Z"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Redo:"})," Ctrl + Y or Ctrl + Shift + Z"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Zoom In:"})," Ctrl + Plus"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"Zoom Out:"})," Ctrl + Minus"]})]}),(0,l.jsx)("p",{children:"Enjoy creating your masterpiece!"})]})]})]})}n(30461);var g=n(85266),f=n(67800),y=n(96024);function m(e){let{tool:t,setTool:n}=e;return(0,l.jsx)("div",{className:"actionBar",children:Object.values(a).map((e,s)=>(0,l.jsxs)("div",{className:"inputWrapper ".concat(t===e?"selected":""),onClick:()=>n(e),children:[(0,l.jsx)("input",{type:"radio",id:e,checked:t===e,onChange:()=>n(e),readOnly:!0}),(0,l.jsx)("label",{htmlFor:e,children:e}),"pan"===e&&(0,l.jsx)(y.uMF,{}),"selection"===e&&(0,l.jsx)(f._cq,{}),"rectangle"===e&&(0,l.jsx)(f.TG1,{}),"line"===e&&(0,l.jsx)(f.QLg,{}),"pencil"===e&&(0,l.jsx)(g.H6t,{}),"text"===e&&(0,l.jsx)(y.e76,{}),(0,l.jsx)("span",{children:s+1})]},e))})}n(98001);var j=n(43799);n(23204),n(87051);var w=n(69610),v=n(68436);function b(e){let{undo:t,redo:n,onZoom:s,scale:i,setScale:r}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"controlPanel",children:[(0,l.jsxs)("div",{className:"zoomPanel",children:[(0,l.jsx)(j.Ay,{content:"Zoom Out",children:(0,l.jsx)("button",{onClick:()=>s(-.1),"aria-label":"Zoom Out",children:(0,l.jsx)(w.uPM,{})})}),(0,l.jsx)(j.Ay,{content:"Set scale to 100%",children:(0,l.jsx)("button",{onClick:()=>r(1),"aria-label":"Set scale to 100%",children:new Intl.NumberFormat("en-GB",{style:"percent"}).format(i)})}),(0,l.jsx)(j.Ay,{content:"Zoom In",children:(0,l.jsx)("button",{onClick:()=>s(.1),"aria-label":"Zoom In",children:(0,l.jsx)(w.enO,{})})})]}),(0,l.jsxs)("div",{className:"editPanel",children:[(0,l.jsx)(j.Ay,{content:"Undo last action",children:(0,l.jsx)("button",{onClick:t,"aria-label":"Undo last action",children:(0,l.jsx)(v.cyc,{})})}),(0,l.jsx)(j.Ay,{content:"Redo last action",children:(0,l.jsx)("button",{onClick:n,"aria-label":"Redo last action",children:(0,l.jsx)(v.r4$,{})})})]})]})," ",(0,l.jsxs)("a",{className:"link",href:"https://github.com/mirayatech",target:"_blank",children:[(0,l.jsx)(f.BR8,{}),"Created by Miraya"]})]})}var k=n(6109);let E=(e,t,n)=>{switch(n.type){case"line":case"rectangle":e.draw(n.roughElement);break;case"pencil":{if(!n.points)throw Error("Pencil element points are undefined");let e=S((0,k.Ay)(n.points).map(e=>{if(2!==e.length)throw Error("Expected point to have exactly 2 elements, got ".concat(e.length));return[e[0],e[1]]}));t.fill(new Path2D(e));break}case"text":{t.textBaseline="top",t.font="24px sans-serif";let e=n.text||"";t.fillText(e,n.x1,n.y1);break}default:throw Error("Type not recognised: ".concat(n.type))}},S=e=>{if(!e.length)return"";let t=e.reduce((e,t,n,l)=>{let[s,i]=t,[r,o]=l[(n+1)%l.length];return e.push(s.toString(),i.toString(),((s+r)/2).toString(),((i+o)/2).toString()),e},["M",...e[0].map(e=>e.toString()),"Q"]);return t.push("Z"),t.join(" ")},C=(e,t,n,l,s,r)=>{let o=i.A.generator();switch(r){case a.line:case a.rectangle:{let i=r===a.line?o.line(t,n,l,s):o.rectangle(t,n,l-t,s-n,{roughness:0,fill:"red"});return{id:e,x1:t,y1:n,x2:l,y2:s,type:r,roughElement:i}}case a.pencil:return{id:e,x1:0,y1:0,x2:0,y2:0,type:r,points:[{x:t,y:n}],roughElement:null};case a.text:return{id:e,type:r,x1:t,y1:n,x2:l,y2:s,text:""};default:throw Error("Type not recognised: ".concat(r))}},M=(e,t,n,l,s)=>5>Math.abs(e-n)&&5>Math.abs(t-l)?s:null,N=(e,t,n)=>n.map(n=>({...n,position:L(e,t,n)})).find(e=>null!==e.position),L=(e,t,n)=>{let{type:l,x1:s,x2:i,y1:r,y2:o}=n;switch(l){case a.line:{let n=A(s,r,i,o,e,t),l=M(e,t,s,r,"start"),a=M(e,t,i,o,"end");return l||a||n}case a.rectangle:{let n=M(e,t,s,r,"topLeft"),l=M(e,t,i,r,"topRight"),a=M(e,t,s,o,"bottomLeft"),c=M(e,t,i,o,"bottomRight"),d=e>=s&&e<=i&&t>=r&&t<=o?"inside":null;return n||l||a||c||d}case a.pencil:return n.points.some((l,s)=>{let i=n.points[s+1];return!!i&&null!=A(l.x,l.y,i.x,i.y,e,t,5)})?"inside":null;case a.text:return e>=s&&e<=i&&t>=r&&t<=o?"inside":null;default:throw Error("Type not recognised: ".concat(l))}},A=function(e,t,n,l,s,i){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o={x:e,y:t},a={x:n,y:l},c={x:s,y:i};return Math.abs(R(o,a)-(R(o,c)+R(a,c)))<r?"inside":null},R=(e,t)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),T=e=>{switch(e){case"topLeft":case"bottomRight":return"nwse-resize";case"topRight":case"bottomLeft":return"nesw-resize";case"start":case"end":case"inside":return"move";default:return"default"}},z=(e,t,n,l)=>{let{x1:s,y1:i,x2:r,y2:o}=l;switch(n){case"start":case"topLeft":return{x1:e,y1:t,x2:r,y2:o};case"topRight":return{x1:s,y1:t,x2:e,y2:o};case"bottomLeft":return{x1:e,y1:i,x2:r,y2:t};case"end":case"bottomRight":return{x1:s,y1:i,x2:e,y2:t};default:return l}},O=e=>["line","rectangle"].includes(e),Z=e=>{let{type:t,x1:n,y1:l,x2:s,y2:i}=e;return t===a.rectangle?{x1:Math.min(n,s),y1:Math.min(l,i),x2:Math.max(n,s),y2:Math.max(l,i)}:n<s||n===s&&l<i?{x1:n,y1:l,x2:s,y2:i}:{x1:s,y1:i,x2:n,y2:l}};function B(){let e=a.selection,{elements:t,setElements:n,undo:c,redo:d}=r([]),[u,x]=(0,s.useState)({x:0,y:0}),[h,g]=(0,s.useState)({x:0,y:0}),[f,y]=(0,s.useState)("none"),[j,w]=(0,s.useState)(e),[v,k]=(0,s.useState)(),[S,M]=(0,s.useState)(1),[L,A]=(0,s.useState)({x:0,y:0}),R=(0,s.useRef)(null),B=o();(0,s.useLayoutEffect)(()=>{let e=document.getElementById("canvas"),n=e.getContext("2d"),l=i.A.canvas(e);n.clearRect(0,0,e.width,e.height);let s=e.width*S,r=e.height*S,o=(s-e.width)/2,a=(r-e.height)/2;A({x:o,y:a}),n.save(),n.translate(u.x*S-o,u.y*S-a),n.scale(S,S),t.forEach(e=>{"writing"===f&&v&&v.id===e.id||E(l,n,e)}),n.restore()},[t,f,v,u,S]),(0,s.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&("z"===e.key?e.shiftKey?d():c():"y"===e.key&&d())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[c,d]),(0,s.useEffect)(()=>{let e=e=>{B.has("Meta")||B.has("Control")?U(-.01*e.deltaY):x(t=>({x:t.x-e.deltaX,y:t.y-e.deltaY}))};return document.addEventListener("wheel",e),()=>{document.removeEventListener("wheel",e)}},[B]),(0,s.useEffect)(()=>{let e=R.current;"writing"===f&&e&&v&&setTimeout(()=>{e.focus(),e.value=v.text||""},0)},[f,v]);let P=(e,l,s,i,r,o,c)=>{let d=[...t];switch(o){case a.line:case a.rectangle:d[e]=C(e,l,s,i,r,o);break;case a.pencil:{let t=d[e].points||[];d[e].points=[...t,{x:i,y:r}];break}case a.text:{let t=document.getElementById("canvas");if(!(t instanceof HTMLCanvasElement))throw Error("Canvas element not found");let n=t.getContext("2d");if(!n)throw Error("Could not get 2D context from canvas");if(!c)throw Error("No text options provided for text tool");let i=n.measureText(c.text).width;d[e]={...C(e,l,s,l+i,s+24,o),text:c.text};break}default:throw Error("Type not recognised: ".concat(o))}n(d,!0)},I=e=>({clientX:(e.clientX-u.x*S+L.x)/S,clientY:(e.clientY-u.y*S+L.y)/S}),U=e=>{M(t=>Math.min(Math.max(t+e,.1),20))};return(0,l.jsxs)("div",{children:[(0,l.jsx)(p,{}),(0,l.jsx)(m,{tool:j,setTool:w}),(0,l.jsx)(b,{undo:c,redo:d,onZoom:U,scale:S,setScale:M}),"writing"===f?(0,l.jsx)("textarea",{ref:R,onBlur:e=>{if(v){let{id:t,x1:n,y1:l,type:s}=v,i=v.x2||n,r=v.y2||l;y("none"),k(null),P(t,n,l,i,r,s,{text:e.target.value})}else console.error("No element selected when handleBlur was called")},className:"textArea",style:{top:v?(v.y1-2)*S+u.y*S-L.y:0,left:v?v.x1*S+u.x*S-L.x:0,font:"".concat(24*S,"px sans-serif")}}):null,(0,l.jsx)("canvas",{id:"canvas",width:window.innerWidth,height:window.innerHeight,onMouseDown:e=>{if("writing"===f)return;let{clientX:l,clientY:s}=I(e);if(j===a.pan||1===e.button||B.has(" ")||1===e.button||B.has(" ")){y("panning"),g({x:l,y:s}),document.body.style.cursor="grabbing";return}if(j===a.selection){let e=N(l,s,t);if(e){let t={...e};if("pencil"===e.type&&e.points){let n=e.points.map(e=>l-e.x),i=e.points.map(e=>s-e.y);t={...t,xOffsets:n,yOffsets:i}}else{let e=l-t.x1,n=s-t.y1;t={...t,offsetX:e,offsetY:n}}k(t),n(e=>e),"inside"===e.position?y("moving"):y("resizing")}}else{let e=C(t.length,l,s,l,s,j);n(t=>[...t,e]),k(e),y("text"===j?"writing":"drawing")}},onMouseMove:e=>{let{clientX:l,clientY:s}=I(e);if("panning"===f){let e=l-h.x,t=s-h.y;x({x:u.x+e,y:u.y+t});return}if(j===a.selection){let n=N(l,s,t);n&&n.position?e.target.style.cursor=T(n.position):e.target.style.cursor="default"}if("drawing"===f){let e=t.length-1,{x1:n,y1:i}=t[e];P(e,n,i,l,s,j)}else if("moving"===f&&v)if("pencil"===v.type&&"points"in v&&"xOffsets"in v&&"yOffsets"in v){let e=v.points.map((e,t)=>({x:l-v.xOffsets[t],y:s-v.yOffsets[t]})),i=[...t];i[v.id]={...i[v.id],points:e},n(i,!0)}else{let{id:e,x1:t,x2:n,y1:i,y2:r,type:o,offsetX:a,offsetY:c}=v,d=l-(null!=a?a:0),u=s-(null!=c?c:0),x="text"===o&&v.text?{text:v.text}:void 0;P(e,d,u,d+(n-t),u+(r-i),o,x)}else if("resizing"===f&&v&&v.position){let{id:e,type:t,position:n,...i}=v;if("string"==typeof n){let{x1:r,y1:o,x2:a,y2:c}=z(l,s,n,i);P(e,r,o,a,c,t)}}},onMouseUp:e=>{let{clientX:n,clientY:l}=I(e);if(v){let e=v.id,{id:s,type:i}=t[e];if(("drawing"===f||"resizing"===f)&&O(i)){let{x1:n,y1:l,x2:r,y2:o}=Z(t[e]);P(s,n,l,r,o,i)}let r=v.offsetX||0,o=v.offsetY||0;if("text"===v.type&&n-r===v.x1&&l-o===v.y1)return void y("writing")}"writing"!==f&&("panning"===f&&(document.body.style.cursor="default"),y("none"),k(null))},style:{position:"absolute",zIndex:1}})]})}},87051:()=>{},98001:()=>{}}]);